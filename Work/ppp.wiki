1）什么是LCP？
	链路控制协议（LCP) LCP 建立点对点链路，是 PPP 中实际工作的部分。LCP 位
	于物理层的上方，负责建立、配置和测试数据链路连接。LCP 还负责协商和设置
	WAN 数据链路上的控制选项，这些选项由 NCP 处理。
2）NCP是什么？
	网络控制协议
	PPP允许多个网络协议共用一个链路，网络控制协议 (NCP) 负责连接PPP（第二层
	）和网络协议 (第三层) 。对于所使用的每个网络层协议，PPP都分别使用独立的
	NCP来连接。例如，IP 使用 IP 控制协议 (IPCP)，IPX 使用 Novell IPX 控制协
	议 (IPXCP)。
认证协议：
	PAP：口令验证协议(Password Authentication Protocol)
	CHAP：挑战握手验证协议(Challenge-Handshake Authentication Protocol)
------------------------------------------------------------------------------
阶段一：创建PPP链路
	LCP负责创建链路。在这个阶段，将对基本的通讯方式进行选择。链路两端设备通
	过LCP向对方发送配置信息报文（Configure Packets）。 一旦一个配置成功信息
	报文（Configure-Ack Packet）被发送且被接收，就完成交换，进入LCP开启状态。
	在链路创建阶段，只是对验证协议进行选择，用户验证将在第2阶段实现。
阶段二：用户验证
	在这个阶段，客户端会将自己的身份发送给远端的接入服务器。该阶段使用一种
	安全验证方式避免第三方窃取数据或冒充远程客户接管与客户端的连接。在认证
	完成之前，禁止从认证阶段前进到网络层协议阶段。如果认证失败，认证者应该
	跃迁到链路终止阶段。

	在这一阶段里，只有链路控制协议、认证协议，和链路质量监视协议的 packets
	是被允许的。在该阶段里接收到的其他的packets必须被静静的丢弃。

	最常用的认证协议有口令验证协议（PAP）和挑战握手验证协议（CHAP）。

阶段三：调用网络层协议
	认证阶段完成之后，PPP将调用在链路创建阶段（阶段1）选定的各种网络控制协
	议（NCP）。选定的NCP解决PPP链路之上的高层协议问题，例如，在该阶段IP 控
	制协议（IPCP）可以向拨入用户分配动态地址。
	这样，经过三个阶段以后，一条完整的PPP链路就建立起来了。
三、 认证方式

1）口令验证协议（PAP）

PAP是一种简单的明文验证方式。NAS（网络接入服务器，Network Access Server）要求用户提供用户名和口令，PAP以明文方式返回用户信息。很明显，这种验证方式的安全性较差，第三方可以很容易的获取被传送的用户名和口令，并利用这些信息与NAS建立连接获取NAS提供的所有资源。所以，一旦用户密码被第三方窃取，PAP无法提供避免受到第三方攻击的保障措施。

2）挑战-握手验证协议（CHAP）

CHAP是一种加密的验证方式，能够避免建立连接时传送用户的真实密码。NAS向远程用户发送一个挑战口令（challenge），其中包括会话ID和一个任意生成的挑战字串（arbitrary challengestring）。远程客户必须使用MD5单向哈希算法（one-way hashing algorithm）返回用户名和加密的挑战口令，会话ID以及用户口令，其中用户名以非哈希方式发送。

CHAP对PAP进行了改进，不再直接通过链路发送明文口令，而是使用挑战口令以哈希算法对口令进行加密。因为服务器端存有客户的明文口令，所以服务器可以重复客户端进行的操作，并将结果与用户返回的口令进行对照。CHAP为每一次验证任意生成一个挑战字串来防止受到再现攻击（replay attack）。在整个连接过程中，CHAP将不定时的向客户端重复发送挑战口令，从而避免第3方冒充远程客户（remote client impersonation）进行攻击。

四、PPP协议的应用

PPP协议是目前广域网上应用最广泛的协议之一，它的优点在于简单、具备用户验证能力、可以解决IP分配等。

家庭拨号上网就是通过PPP在用户端和运营商的接入服务器之间建立通信链路。 目前，宽带接入正在成为取代拨号上网的趋势，在宽带接入技术日新月异的今天，PPP也衍生出新的应用。典型的应用是在ADSL（非对称数据用户环线，Asymmetrical Digital Subscriber Loop）接入方式当中，PPP与其他的协议共同派生出了符合宽带接入要求的新的协议，如PPPoE（PPP over Ethernet），PPPoA（PPP over ATM）。

利用以太网（Ethernet）资源，在以太网上运行PPP来进行用户认证接入的方式称为PPPoE。PPPoE即保护了用户方的以太网资源，又完成了ADSL的接入要求，是目前ADSL接入方式中应用最广泛的技术标准。

同样，在ATM（异步传输模式，Asynchronous Transfer Mode）网络上运行PPP协议来管理用户认证的方式称为PPPoA。它与PPPoE的原理相同，作用相同；不同的是它是在ATM网络上，而PPPoE是在以太网网络上运行，所以要分别适应ATM标准和以太网标准。

PPP协议的简单完整使它得到了广泛的应用，相信在未来的网络技术发展中，它还可以发挥更大的作用。
------------------------------------------------------------------------------
	PPP帧格式与HDLC协议帧格式非常类似。他们之间的主要区别是，PPP面向字符的
	而HDLC是面向位（比特）的。另外，PPP 协议在调制解调器上使用了字节填充技
	术，所以，所有的帧都是整数个字节。
	PPP协议帧结构：
	8	16	24	40 		Variable	16-32bits
	Flag	Address	Control	Protocol	Information	FCS

	Flag ：标志字段，表示帧的起始或结束。所有的PPP帧都是由一个标准的HDLC标
	志二进制字节（01111110）作为开始的。如果它正好出现在Information字段中，
	则需要进行字节填充。具体可参见本系列图书《网络工程师必读——网络工程基础
	》一书。

	Address：地址字段，它总是被设置成二进制值：1111 1111，以表示所有的站都
	可以接受该帧。它是一个标准的广播地址（注意：PPP通信不分配个人站地址）。

	Control ：控制字段，默认为二进制值：00000011，表示这是一个无序号帧。也
	就是说，在默认情况下，PPP协议并没有采用序列号和确认应答来实现可靠传输。
	在有噪声的环境下（如无线网络中），可以利用编号模式来实现可靠传输。
	Protocol：协议字段，识别帧中Information 字段封装的协议。已定义的协议代
	码包括：LCP、NCP、IP、IPX、AppleTalk等。以0 位作为开始的协议是网络层协
	议，如IP、IPX、XNS等；以1位作产开始的协议被用于协商其他的协议，如LCP、
	NCP。协议的默认大小为2字节，但是通过LCP可以将它协商为1个字节。  	通过LCP协商。。。

	Information：信息字段（又称“净荷域”），可以是任意长度，包含Protocol 字
	段中指定的协议数据报。如果在线路建立过程中没有通过LCP 协商该长度，则使
	用默认长度1500字节。如果有需要的话，在该字段之后可以加上一些填充字节。

	FCS：帧校验序列（FCS）字段，通常为16位（2个字节长），也可以为4个字节。
	PPP的执行可以通过预先协议采用32位FCS来提高差错检测效果。 PPP数据帧的格
	式看上去很像ISO 的HDLC（高级链路控制协议）标准。每一帧都以标志字符0x7e
	开始和结束。紧接着是一个地址字节，值始终是0xff，然后是一个值为0x03的控
	制字节。接下来是协议字段，类似于以太网中类型字段的功能。 CRC字段（或FC
	S，帧检验序列）是一个循环冗余检验码，以检测数据帧中的错误。 

	由于标志字符的值是0x7e，因此当该字符出现在信息字段中时，PPP 需要对它进
	行转义。在同步链路中，该过程是通过一种称作比特填充（bitstuffing） 的硬
	件技术来完成的；在异步链路中，特殊字符0x7d用作转义字符。当它出现在 PPP
	数据帧中时，那么紧接着的字符的第6个比特要取其补码，具体实现过程如下： 
	(1)当遇到字符0x7e时，需连续传送两个字符：0x7d和0x5e，以实现标志 字符的
	转义。
	(2)当遇到转义字符0x7d 时，需连续传送两个字符：0x7d和0x5d，以实现转义字
	符的转义。
	(3)默认情况下，如果字符的值小于0x20（比如，一个ASCII控制字符），一般都
	要进行转义。例如，遇到字符0x01时需连续传送0x7d和0x21两个字符（这时，第
	6个比特取补码后变为1，而前面两种情况均把它变为0。


PPP与HDLC的区别  
	1.从网络层交下来的分组，变成为数据链路层的数据。信息字段的长度没有具体
	规定。数据链路层在信息字段的头尾各加上24bit 的控制信息，这样就构成了一
	个完整的帧。HDLC规定了一个帧的开头（即首部中的第一个字节）和结尾（即尾
	部中的最后一个字节）各放入一个特殊的标记，作为一个帧的边界。这个标记就
	叫做标志字段F。标志字段F为６个连续１加上两边各一个０共８位。地址字段A
	也是８个比特，它一般被写入次站的地址。帧校验序列FSC字共占16 位，采用CR
	C-CCITT生成多项式。控制字段功８位，是最复杂的字段,HDLC的许多重要功能都
	要靠控制字段来实现。根据其前面两个比特的取值，可将HDLC的许多帧划分为三
	大类，即信息帧、监督帧和无编号帧。     
    
	2.点对点协议PPP的帧结构：PPP帧格式和HDLC的相似，PPP帧的前3个字段和最后
	两个字段和HDLC的格式是一样的。PPP不是面向比特的，因而所有的PPP帧的长度
	都是整数个字节。与HDLC不同的是多了一个2个字节的协议字段。当协议字段为
	0X0021时，信息字段就是IIP数据报。若为0XC021,则信息字段是链路控制数据，
	而0X8021表示这是网络控制数据。
    
	HDLC使用时是cisco私有的协议，该协议仅适合cisco设备间互连用，不能用于其
	他设备.
